{"version":3,"sources":["app.js"],"names":["navigator","serviceWorker","register","then","console","log","document","addEventListener","url","body","querySelector","currencyConvertFrom","currencyConvertTo","button","createNode","nodeType","currency","node","createElement","innerText","addCurrenciesToDOM","currencies","length","nodeTypeToCreate","map","appendChild","fetchCurrencyRate","fetch","inputAmount","exchangeRate","data","calculateExchangeRate","value","Object","values","input","originalCurrencyInputField","convertedCurrencyInputField","convertedCurrency","toFixed","concat","catch","err","error","getExchangeRate","curr1","curr2","arguments","currencyUrl","buildAPIUrl","addEventListeners","e","event","keyCode","detectEnterPressed","init","window","caches","match","response","json","keys","results","sort","res"],"mappings":"sJAGI,kBAAmBA,WAHvBA,UAAAC,cAAAC,SAAA,SAAAC,KAAA,WAKIC,QAAQC,IAAI,+BAOhBC,SAASC,iBAAiB,mBAAoB,WAH9C,IAyDUC,EAzDVC,EAAAH,SAAAI,cAAA,QAKQC,EAAsBL,SAASI,cAAc,2BAC7CE,EAAoBN,SAASI,cAAc,yBAHnDJ,EAASC,SAAiBG,cAAA,YAClBD,EAA8BH,SAApCI,cACA,yBAEMG,EAAgCP,SAAAI,cACtC,0BAUA,SAASI,EAAWC,EAAUC,GAC5B,GAAiB,cAAbD,GAAyC,cAAbC,EAC9B,MAAO,sDAGT,IAAMC,EAAOX,SAASY,cAAcH,GAGpC,OAFAE,EAAKE,UAAYH,EAEVC,EAMT,SAASG,EAAmBC,GAC1B,GAA0B,IAAtBA,EAAWC,QAA+B,cAAfD,EAC7B,MAAO,iDAGT,IAAME,EAAmB,SAEzBF,EAAWG,IAAI,SAAAR,GACbL,EAAoBc,YAAYX,EAAWS,EAAkBP,IAC7DJ,EAAkBa,YAAYX,EAAWS,EAAkBP,MAsD5D,SAAAU,EAAAlB,GAFD,GAAY,cAARA,EAIJmB,MAAA,qCAGIA,MAAMC,GACNzB,KAAM0B,SAAAA,GAAAA,OAAAA,EAAAA,SAFP1B,KAAK,SAAA2B,GAIJC,IAAAA,EAtDgBzB,SAASI,cAAc,gBAAgBsB,MAwDlDH,EAAAI,OAAAC,OAAAJ,IA8CX,SAA+BD,EAAcM,GAO3CC,GAAAA,IAAAA,UAAAA,OACAC,MAAAA,uFAGF,IAAAC,EAAAH,EAAAN,EAJEO,EAA2BJ,MAAQG,EAOrCE,EAA6BL,MAAAM,EAAAC,QAAA,KApE3BR,WAAAA,EAAAA,mBAAAF,GAAAW,OAAA,CAAAZ,OAQGa,MAAM,SAAAC,GAAA,OAOXtC,QAAAuC,MAAA,wEALgFD,KA0B/E,SAAAE,IAKDlB,EAjBE,SAAAmB,EAAAC,GACD,OAAA,IAAAC,UAAAzB,OALU,wEAGH0B,0DAAwEH,EAAxE,IAAiFC,EAAjF,iBAWMG,CAHM3C,SAASI,cAAc,2BAA2BsB,MAOtE1B,SAAAI,cAAA,yBAAAsB,QA8BA,SAASkB,IAKTrC,EAAAN,iBAAA,QAAAqC,GAHEnC,EAAKF,iBAAiB,UAAW,SAAA4C,GAAA,OAvB/BP,SAAAA,GACD,GAAA,cAAAQ,EACF,MAAA,oFAHuB,KAAlBA,EAAMC,SACRT,IAuBoCU,CAAmBH,KAW3DI,IAzHQ/C,EAAM,0DAGR,WAAYgD,OACdC,OAAOC,MAAMlD,GAAKL,KAAK,SAAAwD,GACjBA,GACFA,EAASC,OAAOzD,KAAK,SAAA2B,GAGnBV,EAFmBa,OAAO4B,KAAK/B,EAAKgC,SAASC,YAWrDpC,MAAMnB,GACEL,KAAA,SAAA6D,GAAA,OAAWJ,EAAXA,SACLzD,KAAK,SAAA2B,GAGJV,EAFmBa,OAAA4B,KAAY/B,EAAKgC,SAAjBC,UAIdtB,MACLrC,SAAAA,GAAAA,OARJA,QAAAuC,MAAA,2EAYDD","file":"app.min.js","sourcesContent":["/**\n * Register Service Worker\n */\nif ('serviceWorker' in navigator) {\n  navigator.serviceWorker.register('sw.js').then(() => {\n    console.log('Service Worker Registered');\n  });\n}\n\n/**\n * Add all the logic of the website in the DOMContentLoaded Event Listener\n */\ndocument.addEventListener('DOMContentLoaded', () => {\n  const body = document.querySelector('body');\n  const currencyConvertFrom = document.querySelector('.currency__convert-from');\n  const currencyConvertTo = document.querySelector('.currency__convert-to');\n  const button = document.querySelector('.convert');\n  const originalCurrencyInputField = document.querySelector(\n    'input#original_amount',\n  );\n  const convertedCurrencyInputField = document.querySelector(\n    'input#converted_amount',\n  );\n\n  /**\n   * Create HTML Element and set inline value of the currency\n   */\n  function createNode(nodeType, currency) {\n    if (nodeType === 'undefined' || currency === 'undefined') {\n      return 'nodeType or currency parameter cannot be undefined.';\n    }\n\n    const node = document.createElement(nodeType);\n    node.innerText = currency;\n\n    return node;\n  }\n\n  /**\n   * Add each currency to both select HTML Elements on the DOM\n   */\n  function addCurrenciesToDOM(currencies) {\n    if (currencies.length === 0 || currencies === 'undefined') {\n      return 'Currencies array cannot be empty or undefined.';\n    }\n\n    const nodeTypeToCreate = 'option';\n\n    currencies.map(currency => {\n      currencyConvertFrom.appendChild(createNode(nodeTypeToCreate, currency));\n      currencyConvertTo.appendChild(createNode(nodeTypeToCreate, currency));\n    });\n  }\n\n  /**\n   * Get amount in the input field\n   */\n  function getInputAmount() {\n    const inputAmount = document.querySelector('input#amount').value;\n    return inputAmount;\n  }\n\n  /**\n   * Get a list of all the currencies using the API\n   */\n  function fetchListOfCurrencies() {\n    const url = 'https://free.currencyconverterapi.com/api/v5/currencies';\n\n    // Before we fetch from the API itself, check if we don't have a cached version locally\n    if ('caches' in window) {\n      caches.match(url).then(response => {\n        if (response) {\n          response.json().then(data => {\n            const currencies = Object.keys(data.results).sort();\n\n            addCurrenciesToDOM(currencies);\n          });\n        }\n      });\n\n      return;\n    }\n\n    // This will fetch the data from the API if we don't have a cached version\n    fetch(url)\n      .then(res => res.json())\n      .then(data => {\n        const currencies = Object.keys(data.results).sort();\n\n        addCurrenciesToDOM(currencies);\n      })\n      .catch(err =>\n        console.error(\n          `The following error occured while trying to get the list of currencies. ${err}`,\n        ),\n      );\n  }\n\n  /**\n   * Fetch the exchange rate between two currencies\n   */\n  function fetchCurrencyRate(url) {\n    if (url === 'undefined') {\n      return 'URL Parameter cannot be undefined.';\n    }\n\n    fetch(url)\n      .then(res => res.json())\n      .then(data => {\n        const inputAmount = getInputAmount();\n        const exchangeRate = Object.values(data);\n\n        calculateExchangeRate(...exchangeRate, inputAmount);\n      })\n      .catch(err =>\n        console.error(\n          `The following error occured while trying to get the conversion rate. ${err}`,\n        ),\n      );\n  }\n\n  /**\n   * Build the API URL to use to get the conversion rate for a specific set of currencies\n   */\n  function buildAPIUrl(curr1, curr2) {\n    if (arguments.length !== 2) {\n      return 'You need to specify both arguments for the URL to be built correctly.';\n    }\n\n    const currencyUrl = `https://free.currencyconverterapi.com/api/v5/convert?q=${curr1}_${curr2}&compact=ultra`;\n    return currencyUrl;\n  }\n\n  /**\n   * Get the two currencies selected in the DOM and get the exchange rate\n   */\n  function getExchangeRate() {\n    const currency1 = document.querySelector('.currency__convert-from').value;\n    const currency2 = document.querySelector('.currency__convert-to').value;\n\n    const url = buildAPIUrl(currency1, currency2);\n    fetchCurrencyRate(url);\n  }\n\n  /**\n   * Detect if the enter button has been pressed and get the exchange rate\n   */\n  function detectEnterPressed(event) {\n    if (event === 'undefined') {\n      return \"Most likely the DOM key event listener wasn't started. 'Enter' key will not fire.\";\n    }\n\n    if (event.keyCode === 13) {\n      getExchangeRate();\n    }\n  }\n\n  /**\n   * Calculate the exchange rate based on the amount entered and the currencies selected\n   */\n  function calculateExchangeRate(exchangeRate, input) {\n    if (arguments.length !== 2) {\n      return 'You need to specify both arguments for the exchange rate to be calculated correctly.';\n    }\n\n    const convertedCurrency = input * exchangeRate;\n\n    originalCurrencyInputField.value = input;\n    convertedCurrencyInputField.value = convertedCurrency.toFixed(2);\n  }\n\n  /**\n   * Add event listeners that is needed\n   */\n  function addEventListeners() {\n    button.addEventListener('click', getExchangeRate);\n    body.addEventListener('keydown', e => detectEnterPressed(e));\n  }\n\n  /**\n   * Add Event Listeners and get the currencies to display on the DOM\n   */\n  function init() {\n    addEventListeners();\n    fetchListOfCurrencies();\n  }\n\n  init();\n});\n"]}